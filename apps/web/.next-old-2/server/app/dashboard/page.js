(()=>{var e={};e.id=702,e.ids=[702],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3090:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c}),r(1566),r(1400),r(3443);var s=r(9324),a=r(562),n=r(2561),l=r.n(n),i=r(2691),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let c=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,1566)),"/Users/marianfabian/Projects/sentinel/apps/web/src/app/dashboard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,1400)),"/Users/marianfabian/Projects/sentinel/apps/web/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,3443,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/marianfabian/Projects/sentinel/apps/web/src/app/dashboard/page.tsx"],u="/dashboard/page",h={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},8149:(e,t,r)=>{Promise.resolve().then(r.bind(r,4472))},6500:(e,t,r)=>{Promise.resolve().then(r.bind(r,501))},8437:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,5510,23)),Promise.resolve().then(r.t.bind(r,9137,23)),Promise.resolve().then(r.t.bind(r,2141,23)),Promise.resolve().then(r.t.bind(r,9188,23)),Promise.resolve().then(r.t.bind(r,2587,23)),Promise.resolve().then(r.t.bind(r,5716,23))},4472:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(3316),a=r(4381),n=r(4364);function l({score:e,size:t="md",showLabel:r=!0}){return(0,s.jsxs)("span",{className:`inline-flex items-center rounded-full border font-medium ${e>=80?"bg-green-100 text-green-800 border-green-200":e>=50?"bg-yellow-100 text-yellow-800 border-yellow-200":"bg-red-100 text-red-800 border-red-200"} ${{sm:"text-xs px-2 py-0.5",md:"text-sm px-2.5 py-1",lg:"text-base px-3 py-1.5"}[t]}`,children:[s.jsx("span",{className:"font-bold",children:Math.round(e)}),r&&(0,s.jsxs)("span",{className:"ml-1 font-normal",children:["(",e>=80?"Healthy":e>=50?"Warning":"Critical",")"]})]})}function i({rule:e}){let t=e=>{if(!e)return"Never";let t=new Date(e),r=Math.floor((new Date().getTime()-t.getTime())/6e4),s=Math.floor(r/60);return r<1?"Just now":r<60?`${r}m ago`:s<24?`${s}h ago`:`${Math.floor(s/24)}d ago`};return s.jsx(n.default,{href:`/dashboard/rules/${e.id}`,children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow border border-gray-200 hover:shadow-lg transition-shadow p-4 cursor-pointer",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xl",children:(e=>{switch(e){case"price":return"\uD83D\uDCB0";case"availability":return"\uD83D\uDCE6";case"text":return"\uD83D\uDCDD";case"number":return"\uD83D\uDD22";default:return"\uD83D\uDCCA"}})(e.ruleType)}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 truncate",children:e.name}),!e.enabled&&s.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-100 text-gray-600 rounded-full",children:"Paused"})]}),s.jsx("p",{className:"mt-1 text-sm text-gray-500 truncate",children:e.source.domain})]}),s.jsx(l,{score:e.healthScore,size:"sm",showLabel:!1})]}),(0,s.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Current Value:"}),s.jsx("p",{className:"font-medium text-gray-900 truncate",children:(()=>{if(!e.currentState?.lastStable)return"No data";let t=e.currentState.lastStable;if("object"==typeof t){if("amount"in t)return`${t.currency??""}${t.amount}`;if("inStock"in t)return t.inStock?"In Stock":"Out of Stock";if("snippet"in t)return t.snippet?.substring(0,50)+"..."}return String(t)})()})]}),(0,s.jsxs)("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Observations:"}),s.jsx("p",{className:"font-medium text-gray-900",children:e.observationCount})]})]}),e.lastErrorCode&&(0,s.jsxs)("div",{className:"mt-3 p-2 bg-red-50 rounded text-sm text-red-700",children:["Last error: ",e.lastErrorCode," (",t(e.lastErrorAt),")"]}),(0,s.jsxs)("div",{className:"mt-4 flex items-center justify-between text-xs text-gray-400",children:[(0,s.jsxs)("span",{children:["Next check: ",t(e.nextRunAt)]}),s.jsx("span",{className:"hover:text-primary-600",children:"View Details →"})]})]})})}var o=r(7455),c=r(7883);function d(){let{user:e,logout:t,isLoading:r}=(0,o.a)(),[d,h]=(0,a.useState)([]),[m,x]=(0,a.useState)({totalRules:0,healthyRules:0,warningRules:0,criticalRules:0,averageScore:0}),[g,p]=(0,a.useState)(!0),[y,b]=(0,a.useState)(null),[f,j]=(0,a.useState)("all"),[v,w]=(0,a.useState)(null),N=async()=>{try{p(!0),b(null);let e=await c.Z.getWorkspaces();0===e.length&&(e=[await c.Z.createWorkspace({name:"My Workspace",type:"ecommerce"})]);let t=e[0].id;w(t);try{let e=await c.Z.getRules(t);h(e);let r=e.length,s=e.filter(e=>e.healthScore>=80).length,a=e.filter(e=>e.healthScore>=50&&e.healthScore<80).length,n=e.filter(e=>e.healthScore<50).length,l=r>0?Math.round(e.reduce((e,t)=>e+t.healthScore,0)/r):0;x({totalRules:r,healthyRules:s,warningRules:a,criticalRules:n,averageScore:l})}catch(e){console.error("API error:",e),h([]),x({totalRules:0,healthyRules:0,warningRules:0,criticalRules:0,averageScore:0})}}catch(e){console.error("Failed to load workspace:",e),b("Could not connect to API. Please try again.")}finally{p(!1)}},S=d.filter(e=>"all"===f||("healthy"===f?e.healthScore>=80:"warning"===f?e.healthScore>=50&&e.healthScore<80:"critical"!==f||e.healthScore<50));return r?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("header",{className:"bg-white shadow-sm border-b",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx(n.default,{href:"/",className:"text-2xl font-bold text-primary-600",children:"Sentinel"}),s.jsx("span",{className:"ml-4 text-gray-400",children:"/"}),s.jsx("span",{className:"ml-4 text-gray-900 font-medium",children:"Dashboard"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:()=>alert("Use the Sentinel browser extension to create new rules.\n\n1. Install the extension\n2. Navigate to any webpage\n3. Click the Sentinel icon\n4. Select an element to monitor"),className:"bg-primary-600 text-white hover:bg-primary-700 px-4 py-2 rounded-md text-sm font-medium",children:"+ New Rule"}),s.jsx(n.default,{href:"/dashboard/settings",className:"text-gray-500 hover:text-gray-700",title:"Settings",children:(0,s.jsxs)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),s.jsx("button",{className:"text-gray-500 hover:text-gray-700",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),e&&(0,s.jsxs)("div",{className:"flex items-center space-x-3 pl-3 border-l border-gray-200",children:[s.jsx("span",{className:"text-sm text-gray-600",children:e.email}),s.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",title:"Logout",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})})]})]})]})})}),(0,s.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[y&&(0,s.jsxs)("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 text-yellow-800 px-4 py-3 rounded-lg flex items-center justify-between",children:[s.jsx("span",{children:y}),s.jsx("button",{onClick:N,className:"text-yellow-600 hover:text-yellow-800 font-medium",children:"Retry"})]}),g?s.jsx("div",{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),s.jsx("p",{className:"mt-4 text-gray-500",children:"Loading dashboard..."})]})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[s.jsx(u,{title:"Total Rules",value:m.totalRules,icon:"\uD83D\uDCCA"}),s.jsx(u,{title:"Healthy",value:m.healthyRules,icon:"✅",color:"green"}),s.jsx(u,{title:"Warning",value:m.warningRules,icon:"⚠️",color:"yellow"}),s.jsx(u,{title:"Critical",value:m.criticalRules,icon:"\uD83D\uDEA8",color:"red"})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6 mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Overall Health"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Average across all rules"})]}),s.jsx(l,{score:m.averageScore,size:"lg"})]}),s.jsx("div",{className:"mt-4 h-2 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full rounded-full transition-all ${m.averageScore>=80?"bg-green-500":m.averageScore>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${m.averageScore}%`}})})]}),s.jsx("div",{className:"flex space-x-2 mb-6",children:["all","healthy","warning","critical"].map(e=>(0,s.jsxs)("button",{onClick:()=>j(e),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${f===e?"bg-primary-600 text-white":"bg-white text-gray-600 hover:bg-gray-100 border border-gray-200"}`,children:[e.charAt(0).toUpperCase()+e.slice(1),"all"!==e&&(0,s.jsxs)("span",{className:"ml-1 text-xs opacity-75",children:["(","healthy"===e?m.healthyRules:"warning"===e?m.warningRules:m.criticalRules,")"]})]},e))}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map(e=>s.jsx(i,{rule:e},e.id))}),0===S.length&&(0,s.jsxs)("div",{className:"text-center py-12",children:[s.jsx("div",{className:"text-4xl mb-4",children:"\uD83D\uDCCA"}),s.jsx("p",{className:"text-gray-500 mb-4",children:0===d.length?"No monitoring rules yet. Create your first rule to get started!":"No rules match the selected filter"}),0===d.length&&s.jsx("button",{onClick:()=>alert("Use the Sentinel browser extension to create new rules.\n\n1. Install the extension\n2. Navigate to any webpage\n3. Click the Sentinel icon\n4. Select an element to monitor"),className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"+ Create First Rule"})]})]})]})]})}function u({title:e,value:t,icon:r,color:a}){return(0,s.jsxs)("div",{className:`rounded-lg shadow border p-4 ${a?({green:"bg-green-50 border-green-100",yellow:"bg-yellow-50 border-yellow-100",red:"bg-red-50 border-red-100"})[a]:"bg-white border-gray-200"}`,children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-2xl",children:r}),s.jsx("span",{className:"text-2xl font-bold text-gray-900",children:t})]}),s.jsx("p",{className:"mt-2 text-sm text-gray-600",children:e})]})}},501:(e,t,r)=>{"use strict";r.d(t,{Providers:()=>n});var s=r(3316),a=r(7455);function n({children:e}){return s.jsx(a.H,{children:e})}},7455:(e,t,r)=>{"use strict";r.d(t,{H:()=>d,a:()=>u});var s=r(3316),a=r(4381),n=r(8015),l=r(7883);let i=(0,a.createContext)(void 0),o="sentinel_token",c="sentinel_user";function d({children:e}){let[t,r]=(0,a.useState)(null),[d,u]=(0,a.useState)(!0),h=(0,n.useRouter)();(0,n.usePathname)();let m=async(e,t)=>{let{accessToken:s,user:a}=await l.Z.login(e,t);localStorage.setItem(o,s),localStorage.setItem(c,JSON.stringify(a)),l.Z.setToken(s),r(a),h.push("/dashboard")},x=async(e,t)=>{await l.Z.register(e,t),await m(e,t)};return s.jsx(i.Provider,{value:{user:t,isLoading:d,login:m,register:x,logout:()=>{localStorage.removeItem(o),localStorage.removeItem(c),l.Z.setToken(null),r(null),h.push("/login")}},children:e})}function u(){let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7883:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});class s{constructor(e){this.token=null,this.baseUrl=e}setToken(e){this.token=e}async request(e,t={}){let{token:r,...s}=t,a=r||this.token,n={"Content-Type":"application/json",...t.headers};a&&(n.Authorization=`Bearer ${a}`);let l=await fetch(`${this.baseUrl}${e}`,{...s,headers:n});if(!l.ok)throw Error((await l.json().catch(()=>({}))).message||`API Error: ${l.status}`);return l.json()}async login(e,t){return this.request("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})})}async register(e,t){return this.request("/auth/register",{method:"POST",body:JSON.stringify({email:e,password:t})})}async getWorkspaces(){return this.request("/workspaces")}async getWorkspace(e){return this.request(`/workspaces/${e}`)}async createWorkspace(e){return this.request("/workspaces",{method:"POST",body:JSON.stringify(e)})}async getSources(e){return this.request(`/sources?workspaceId=${e}`)}async createSource(e){return this.request("/sources",{method:"POST",body:JSON.stringify(e)})}async getRules(e){return this.request(`/rules?workspaceId=${e}`)}async getRule(e){return this.request(`/rules/${e}`)}async createRule(e){return this.request("/rules",{method:"POST",body:JSON.stringify(e)})}async updateRule(e,t){return this.request(`/rules/${e}`,{method:"PATCH",body:JSON.stringify(t)})}async testRule(e){return this.request(`/rules/${e}/test`,{method:"POST"})}async pauseRule(e){return this.request(`/rules/${e}/pause`,{method:"POST"})}async resumeRule(e){return this.request(`/rules/${e}/resume`,{method:"POST"})}async resetRuleHealth(e){return this.request(`/rules/${e}/reset-health`,{method:"POST"})}async getAlerts(e){return this.request(`/alerts?workspaceId=${e}`)}async getNotificationChannels(e){return this.request(`/notification-channels?workspaceId=${e}`)}async getNotificationChannel(e){return this.request(`/notification-channels/${e}`)}async createNotificationChannel(e){return this.request("/notification-channels",{method:"POST",body:JSON.stringify(e)})}async updateNotificationChannel(e,t){return this.request(`/notification-channels/${e}`,{method:"PATCH",body:JSON.stringify(t)})}async deleteNotificationChannel(e){return this.request(`/notification-channels/${e}`,{method:"DELETE"})}async testNotificationChannel(e){return this.request(`/notification-channels/${e}/test`,{method:"POST"})}async getHealthSummary(e){return this.request(`/rules/workspace/${e}/health-summary`)}async getLowHealthRules(e,t=50){return this.request(`/rules/workspace/${e}/low-health?threshold=${t}`)}}let a=new s("https://sentinel.taxinearme.sk/api")},1566:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(6883).createProxy)(String.raw`/Users/marianfabian/Projects/sentinel/apps/web/src/app/dashboard/page.tsx#default`)},1400:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,metadata:()=>i});var s=r(6857),a=r(1945),n=r.n(a);r(5652);let l=(0,r(6883).createProxy)(String.raw`/Users/marianfabian/Projects/sentinel/apps/web/src/app/providers.tsx#Providers`),i={title:"Sentinel - Change Intelligence Platform",description:"Monitor website changes, track prices, and get alerts"};function o({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{className:n().className,children:s.jsx(l,{children:s.jsx("div",{className:"min-h-screen bg-gray-50",children:e})})})})}},5652:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[465,364],()=>r(3090));module.exports=s})();